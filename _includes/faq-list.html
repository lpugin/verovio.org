<script type="text/javascript">
//<![CDATA[
    var faqs = new Array();
    
    /////////////////////////////
    
    function loadExamples() {
        var cat = getParameterByName("cat");
        // no parameter - load what was set in the storage for the comparison
        if (cat === null) cat = '01-general'
        for(i in faqs) {
            console.log(faqs[i].file)
            if (faqs[i].file.startsWith("faqs/" + cat + "/")) {
                $('#faq-' + faqs[i].id ).show();
            }
        }
    }
    
    function getParameterByName(name) {
        var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

//]]>
</script>

<div class="container-fluid">
    
    {% assign categories = "" | split: ',' %}
    {% for collection in site.collections %}
        {% if collection.label == "faqs" %}
    <div class="panel" id="faqs">

        {% for doc in collection.docs %}
            {% assign id = doc.url | split:'/' | last | remove:'.html' %}
            <div id="faq-{{ id }}" style="display: none;">
                
                <a data-toggle="collapse" data-target="#answer-{{ id }}" aria-expanded="false" aria-controls="#answer-{{ id }}" style="cursor: pointer;">
                    <h3 class="test-xmlfile">{{ doc.question }}</h3>
                </a>
                <div id="answer-{{ id }}" class="collapse">
                {{ doc.content }}
                {% assign filePath = doc.path | remove_first: "_" %}
                </div>
                <script type="text/javascript">
                    //<![CDATA[
                        faqs.push({
                            id: "{{ id }}",
                            file: "{{ filePath }}"
                        });
                    //]]>
                    </script>
            </div>
        {% endfor %}
    </div>
        {% endif %}
    {% endfor %}

</div>



<script type="text/javascript">
    //<![CDATA[
    $(document).ready(function() {

        // Could not find a way to have the Jekyll collection not ordered by name ...
        // Order the divs by hand
        $("#faqs > div").sort(function (a, b) {
            return (a.id > b.id);
        }).each(function(){
            var elem = $(this);
            elem.remove();
            $(elem).appendTo("#faqs");
        })

        loadExamples();

    });
    //]]>
</script>